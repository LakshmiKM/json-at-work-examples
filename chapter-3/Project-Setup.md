Test Project Setup
==================
Here's how to create the `speakers-test` project with Ruby, Bundler, and `rake`.

## Contents
- [Create the Project Directory](#create-the-project-directory)
- [Create the Project with `bundle init`](#create-the-project-with-bundle-init)
- [Install Ruby Gems to `Gemfile`](#install-ruby-gems-to-gemfile)
- [Use the Existing `Rakefile`](#use-the-existing-rakefile)
- [Write the Tests](#write-the-tests)
- [Start the Test Server](#start-the-test-server)
- [Run the Tests](#run-the-tests)
- [References](#references)


## Create the Project Directory
First, find a suitable directory for your projects.
`cd ~/projects`

Next, create the `speakers-test` directory and navigate there:
```
mkdir speakers-test

cd speakers-test
```


## Create the Project with `bundle init`
Now, use `bundle init` to create the `Gemfile` for your Ruby project.

Your CLI session should look like this:

```
bundle init
Writing new Gemfile to chapter-3/new-speakers-test/Gemfile
```

Here's the initial `Gemfile` that was generated:

```
# frozen_string_literal: true
source "https://rubygems.org"

# gem "rails"
```


## Install Ruby Gems to `Gemfile`
Now, replace the original `Gemfile` content add the gems we'll need for testing:

```
source 'https://rubygems.org'

gem 'rake'
gem 'minitest'
gem 'unirest'
gem 'awesome_print'
```

[Bundler](http://bundler.io) provides dependency management for Ruby projects.
We'll use Bundler to install the gems mentioned in the `Gemfile` into the
`vendor/bundle` directory for this project. Type the following command:

```
bundle install --path vendor/bundle
```

The above command creates the following files:

* `Gemfile.lock` - Bundler saves the full names and versions of all gems and their versions.
* `.bundle/config` - Bundler persists its environment variables in this file.

You should see the following in your terminal session:

```
json-at-work => bundle install --path vendor/bundle
Fetching gem metadata from https://rubygems.org/........
Fetching version metadata from https://rubygems.org/.
Resolving dependencies...
Installing rake 12.0.0
Installing addressable 2.3.8
Installing awesome_print 1.7.0
Installing json 1.8.6 with native extensions
Installing mime-types 1.25.1
Installing minitest 5.10.1
Using bundler 1.14.6
Installing rest-client 1.6.9
Installing unirest 1.1.2
Bundle complete! 4 Gemfile dependencies, 9 gems now installed.
Bundled gems are installed into ./vendor/bundle.
```

Please see the [Bundler documentation](http://bundler.io) for further details.


## Use the Existing `Rakefile`
We use the well-known [`rake`](http://rake.rubyforge.org) utility to build
and test the code. The `Rakefile` defines the build tasks, and looks like this:

```
require 'rake/testtask'

Rake::TestTask.new(:test) do |t|
  t.libs = %w(lib test)
  t.pattern = 'test/**/*_spec.rb'
  t.warning = false
end

task :default => :test
```

In the above `Rakefile`, `test` is the default task.

Please see the [`rake` documentation](http://rake.rubyforge.org) for further details.


## Write the Tests
Now you're ready to start writing tests in the `test` directory.


## Start the Test Server
Don't forget to run the test server.
```
json-server -p 5000 ./data/speakers.json
```


## Run the Tests
Create another terminal session and run the tests as follows:
```
cd chapter-3/speakers-test

bundle exec rake
```

Please note that `bundle exec rake` runs `rake` within the context of the 
gems installed by Bundler for this project.


## References
* Credit for these setup instructions goes to Chris Kottom's excellent
book, [_The Minitest Cookbook_](https://chriskottom.com/minitestcookbook).
* TOC generated by [md-toc](https://www.npmjs.com/package/md-toc).
